<html><head><title>Joel Vandiver Blog</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="/assets/css/site.css"/></head><body><section class="hero is-black"><div class="hero-body"><div class="container"><h1 class="title"><a href="/index.html">Joel Vandiver</a></h1><h2 class="subtitle">Full Stack Web Developer</h2></div></div></section><section class="section"><div class="container"><div class="columns"><div class="column is-4"><aside class="menu"><p class="menu-label"><p class="menu-label"><a href="/index.html">Home</a></p></p><p class="menu-label"><p class="menu-label">F# Guide</p></p><ul class="menu-list"><li><a href="/2019-04-06-fs-guide-01-value.html">01 Values</a></li><li><a href="/2019-04-06-fs-guide-02-implicit-vs-explicit.html">02 Implicit vs Explicit Value Declaration</a></li><li><a href="/2019-04-06-fs-guide-03-simple.html">03 Simple Values</a></li><li><a href="/2019-04-06-fs-guide-04-list.html">04 List Values</a></li><li><a href="/2019-05-20-fs-guide-05-option.html">05 Option</a></li></ul><p class="menu-label"><p class="menu-label">Topics</p></p><ul class="menu-list"><li><a href="/2019-12-05-fs-type-method-composition.html">F# Type Method Composition</a></li><li><a href="/2019-09-21-fs-aspnetcore-dependency-injection.html">F# ASP.NET Core Dependency Injection</a></li><li><a href="/2019-12-06-fs-destructuring-params.html">Destructuring Params</a></li><li><a href="/2019-12-06-destructuring-anonymous-records.html">Destructuring Anonymous Records</a></li><li><a href="/2019-12-06-fs-lazy.html">Lazy F#</a></li><li><a href="/2019-12-24-fable-fsx.html">Fable FSX Canvas</a></li><li><a href="/2019-12-07-meta-programming-code-to-write-code.html">META Programming   Code to Write Code</a></li><li><a href="/2019-07-13-functional-iteration.html">Functional Iteration</a></li><li><a href="/2019-12-06-why-fs.html">Why F#?</a></li><li><a href="">Use F# Lazy Evaulation for Integration Testing</a></li><li><a href="/2019-06-18-fs-implicit-vs-explicit.html">F# Implicit vs Explicit</a></li><li><a href="/2019-05-06-fs-precomputation.html">F# Precomputation</a></li><li><a href="/2019-06-19-fs-clone-records.html">F# Clone Records</a></li><li><a href="/2019-06-20-discriminated-unions.html">Discriminated Unions</a></li><li><a href="/2019-07-13-fs-anonymous-records.html">F# Anonymous Records</a></li><li><a href="/2019-07-13-fs-immutability-simplifies.html">F# Immutability Simplifies</a></li><li><a href="/2019-07-30-fs-single-case-discriminated-unions.html">F# Single Case Discriminated Unions</a></li></ul><p class="menu-label"><p class="menu-label">DevOps</p></p><ul class="menu-list"><li><a href="/2019-12-07-github-blog-comments.html">GitHub Blog Comments</a></li><li><a href="/2019-12-07-docker-sql-server.html">SQL SERVER on Docker</a></li><li><a href="/2019-08-31-my-first-jekyll-post.html">Welcome to Jekyll!</a></li></ul><p class="menu-label"><p class="menu-label">Fun</p></p><ul class="menu-list"><li><a href="/2019-09-04-nasa-apod.html">NASA APOD</a></li></ul><p class="menu-label"><p class="menu-label">LEAD</p></p><ul class="menu-list"><li><a href="/2019-12-06-reflection-in-leadership.html">Reflection on Leadership</a></li></ul></aside></div><div class="column is-8"><div id="nasa-img-container"></div><div class="content"><h1><a name="precomputation-exploration" class="anchor" href="#precomputation-exploration">Precomputation Exploration</a></h1><p>Create Test Data with Search for the Worst (Last) Value</p>
<pre><code class="language-fsharp"><span class="hljs-keyword">open</span> System

<span class="hljs-keyword">let</span> data = [<span class="hljs-number">0</span> .. <span class="hljs-number">1000000</span>]
<span class="hljs-keyword">let</span> search = <span class="hljs-number">1000000</span></code></pre>
<h2><a name="list-search" class="anchor" href="#list-search">List Search</a></h2><pre><code class="language-fsharp">#time
data |&gt; List.contains (search)
#time</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Real: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.101</span>, CPU: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.109</span>, GC gen0: <span class="hljs-number">29</span>, gen1: <span class="hljs-number">1</span>, gen2: <span class="hljs-number">1</span>
<span class="hljs-keyword">val</span> it : bool = <span class="hljs-keyword">true</span></code></pre>
</blockquote>
<h2><a name="set-search" class="anchor" href="#set-search">Set Search</a></h2><pre><code class="language-fsharp"><span class="hljs-keyword">let</span> set = data |&gt; Set.ofList
#time
set.Contains(search)
#time</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Real: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>, CPU: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>, GC gen0: <span class="hljs-number">0</span>, gen1: <span class="hljs-number">0</span>, gen2: <span class="hljs-number">0</span>
<span class="hljs-keyword">val</span> it : bool = <span class="hljs-keyword">true</span></code></pre>
</blockquote>
<h2><a name="precompute-set-with-partial-application" class="anchor" href="#precompute-set-with-partial-application">Precompute Set with Partial Application</a></h2><pre><code class="language-fsharp"><span class="hljs-keyword">let</span> partiallyApplied (listToSearch: int list) (value: int) : bool = 
    <span class="hljs-keyword">let</span> setToSearch = listToSearch |&gt; Set.ofList
    setToSearch.Contains(value)

<span class="hljs-keyword">let</span> searcher = partiallyApplied data
#time
searcher search
#time</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Real: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01.568</span>, CPU: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01.562</span>, GC gen0: <span class="hljs-number">410</span>, gen1: <span class="hljs-number">13</span>, gen2: <span class="hljs-number">0</span>
<span class="hljs-keyword">val</span> it : bool = <span class="hljs-keyword">true</span></code></pre>
</blockquote>
<h2><a name="precompute-set-with-function-computation" class="anchor" href="#precompute-set-with-function-computation">Precompute Set with Function Computation</a></h2><pre><code class="language-fsharp"><span class="hljs-keyword">let</span> returnFunction (listToSearch: int list) : int -&gt; bool =
    <span class="hljs-keyword">let</span> setToSearch = listToSearch |&gt; Set.ofList
    <span class="hljs-keyword">fun</span> v -&gt; setToSearch.Contains(v)

<span class="hljs-keyword">let</span> searcher' = returnFunction data
#time
searcher' search
#time</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Real: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>, CPU: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>, GC gen0: <span class="hljs-number">0</span>, gen1: <span class="hljs-number">0</span>, gen2: <span class="hljs-number">0</span>
<span class="hljs-keyword">val</span> it : bool = <span class="hljs-keyword">true</span></code></pre>
</blockquote>
<h2><a name="test-partial-application-with-printer" class="anchor" href="#test-partial-application-with-printer">Test Partial Application with Printer</a></h2><pre><code class="language-fsharp"><span class="hljs-keyword">let</span> printer (items: int list) (item: int) : bool =
    printfn <span class="hljs-string">"Starting Partially Applied Printer"</span>
    <span class="hljs-keyword">let</span> set = items |&gt; Set.ofList
    printfn <span class="hljs-string">"After Set Creation"</span>
    <span class="hljs-keyword">let</span> r = set.Contains item
    printfn <span class="hljs-string">"After Search"</span>
    r

<span class="hljs-keyword">let</span> printerTest = printer data</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp"><span class="hljs-keyword">val</span> printerTest : (int -&gt; bool)</code></pre>
</blockquote>
<pre><code class="language-fsharp">#time
printerTest search
#time</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Starting Partially Applied Printer
After Set Creation
After Search
Real: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01.488</span>, CPU: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">01.468</span>, GC gen0: <span class="hljs-number">411</span>, gen1: <span class="hljs-number">13</span>, gen2: <span class="hljs-number">0</span>
<span class="hljs-keyword">val</span> it : bool = <span class="hljs-keyword">true</span></code></pre>
</blockquote>
<h2><a name="test-precomputation-with-printer" class="anchor" href="#test-precomputation-with-printer">Test Precomputation with Printer</a></h2><pre><code class="language-fsharp"><span class="hljs-keyword">let</span> printer' (items: int list) : int -&gt; bool =
    printfn <span class="hljs-string">"Starting Precomputation Printer"</span>
    <span class="hljs-keyword">let</span> set = items |&gt; Set.ofList
    printfn <span class="hljs-string">"After Set Creation"</span>
    <span class="hljs-keyword">let</span> compute = <span class="hljs-keyword">fun</span> v -&gt; 
        printfn <span class="hljs-string">"Before Search"</span>
        <span class="hljs-keyword">let</span> r = set.Contains v
        printfn <span class="hljs-string">"After Search"</span>
        r
    compute

<span class="hljs-keyword">let</span> printerTest' = printer' data</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Starting Precomputation Printer
After Set Creation
<span class="hljs-keyword">val</span> printerTest' : (int -&gt; bool)</code></pre>
</blockquote>
<pre><code class="language-fsharp">#time
printerTest&#39; search
#time</code></pre>
<blockquote>
<p>Output:</p>
<pre><code class="language-fsharp">Before Search
After Search
Real: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>, CPU: <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00.000</span>, GC gen0: <span class="hljs-number">0</span>, gen1: <span class="hljs-number">0</span>, gen2: <span class="hljs-number">0</span>
<span class="hljs-keyword">val</span> it : bool = <span class="hljs-keyword">true</span></code></pre>
</blockquote>
<h2><a name="conclusion" class="anchor" href="#conclusion">Conclusion</a></h2><p>Precomputation is only applied when a new function is returned from a function.  Partial application does not precompute any encapsulated state.</p>
</div></div></div></div></section><script src="/assets/js/site.js"></script></body></html>