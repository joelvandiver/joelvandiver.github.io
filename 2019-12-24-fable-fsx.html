<html><head><title>Joel Vandiver Blog</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.5.1/css/bulma.min.css"/><link rel="stylesheet" type="text/css" href="/assets/css/site.css"/></head><body><section class="hero is-black"><div class="hero-body"><div class="container"><h1 class="title"><a href="/index.html">Joel Vandiver</a></h1><h2 class="subtitle">Full Stack Web Developer</h2></div></div></section><section class="section"><div class="container"><div class="columns"><div class="column is-4"><aside class="menu"><p class="menu-label"><p class="menu-label"><a href="/index.html">Home</a></p></p><p class="menu-label"><p class="menu-label">F# Guide</p></p><ul class="menu-list"><li><a href="/2019-04-06-fs-guide-01-value.html">01 Values</a></li><li><a href="/2019-04-06-fs-guide-02-implicit-vs-explicit.html">02 Implicit vs Explicit Value Declaration</a></li><li><a href="/2019-04-06-fs-guide-03-simple.html">03 Simple Values</a></li><li><a href="/2019-04-06-fs-guide-04-list.html">04 List Values</a></li><li><a href="/2019-05-20-fs-guide-05-option.html">05 Option</a></li></ul><p class="menu-label"><p class="menu-label">Topics</p></p><ul class="menu-list"><li><a href="/2019-12-05-fs-type-method-composition.html">F# Type Method Composition</a></li><li><a href="/2019-09-21-fs-aspnetcore-dependency-injection.html">F# ASP.NET Core Dependency Injection</a></li><li><a href="/2019-12-06-fs-destructuring-params.html">Destructuring Params</a></li><li><a href="/2019-12-06-destructuring-anonymous-records.html">Destructuring Anonymous Records</a></li><li><a href="/2019-12-06-fs-lazy.html">Lazy F#</a></li><li><a href="/2019-12-24-fable-fsx.html">Fable FSX Canvas</a></li><li><a href="/2019-12-07-meta-programming-code-to-write-code.html">META Programming   Code to Write Code</a></li><li><a href="/2019-07-13-functional-iteration.html">Functional Iteration</a></li><li><a href="/2019-12-06-why-fs.html">Why F#?</a></li><li><a href="">Use F# Lazy Evaulation for Integration Testing</a></li><li><a href="/2019-06-18-fs-implicit-vs-explicit.html">F# Implicit vs Explicit</a></li><li><a href="/2019-05-06-fs-precomputation.html">F# Precomputation</a></li><li><a href="/2019-06-19-fs-clone-records.html">F# Clone Records</a></li><li><a href="/2019-06-20-discriminated-unions.html">Discriminated Unions</a></li><li><a href="/2019-07-13-fs-anonymous-records.html">F# Anonymous Records</a></li><li><a href="/2019-07-13-fs-immutability-simplifies.html">F# Immutability Simplifies</a></li><li><a href="/2019-07-30-fs-single-case-discriminated-unions.html">F# Single Case Discriminated Unions</a></li></ul><p class="menu-label"><p class="menu-label">DevOps</p></p><ul class="menu-list"><li><a href="/2019-12-07-github-blog-comments.html">GitHub Blog Comments</a></li><li><a href="/2019-12-07-docker-sql-server.html">SQL SERVER on Docker</a></li><li><a href="/2019-08-31-my-first-jekyll-post.html">Welcome to Jekyll!</a></li></ul><p class="menu-label"><p class="menu-label">Fun</p></p><ul class="menu-list"><li><a href="/2019-09-04-nasa-apod.html">NASA APOD</a></li></ul><p class="menu-label"><p class="menu-label">LEAD</p></p><ul class="menu-list"><li><a href="/2019-12-06-reflection-in-leadership.html">Reflection on Leadership</a></li></ul></aside></div><div class="column is-8"><div id="nasa-img-container"></div><div class="content"><h1><a name="fable-fsx-canvas" class="anchor" href="#fable-fsx-canvas">Fable FSX Canvas</a></h1><p><a href="https://fable.io/">Fable</a> is a transpiler of F# source code to JavaScript just as TypeScript transpiles down to JavaScript.</p>
<p>Let&#39;s take <a href="https://fable.io/">Fable</a> out for a spin and create a simple <code>canvas</code> drawing of a cirle with an F# script.</p>
<p><canvas id="fable-drawing"></canvas></p>
<script src="/assets/js/scripts/fable-fsx.js"></script>

<h2><a name="prereqs" class="anchor" href="#prereqs">Prereqs</a></h2><blockquote>
<p>Setup the following dependencies (other than F#) on your system:</p>
</blockquote>
<ul>
<li>Node &amp; NPM</li>
<li>Paket (Nuget)</li>
</ul>
<h2><a name="let-39-s-draw-" class="anchor" href="#let-39-s-draw-">Let&#39;s Draw!</a></h2><ul>
<li>Create a new directory, <code>/fable-fsx</code></li>
<li>Open <code>/fable-fsx</code> in your terminal</li>
<li>Add a <code>test.html</code> with the following <code>canvas</code> and <code>script</code>:</li>
</ul>
<pre><code>&lt;canvas id="fable-drawing" ...
&lt;script src="./fable-fsx.js" ...</code></pre><ul>
<li>Add a <code>paket.dependencies</code> with the following contents:</li>
</ul>
<pre><code>source https://api.nuget.org/v3/index.json

nuget Fable.Import.Browser
nuget Fable.Core</code></pre><ul>
<li>Run <code>paket install</code></li>
<li>Add the following <code>fable.fsx</code> file.</li>
</ul>
<pre><code class="language-fsharp">#r <span class="hljs-string">@".\packages\Fable.Core\lib\netstandard2.0\Fable.Core.dll"</span>
#r <span class="hljs-string">@".\packages\Fable.Import.Browser\lib\netstandard1.6\Fable.Import.Browser.dll"</span>

<span class="hljs-keyword">open</span> Fable.Core.JsInterop
<span class="hljs-keyword">open</span> Fable.Import.Browser

<span class="hljs-keyword">let</span> tile = <span class="hljs-number">200.</span>
<span class="hljs-keyword">let</span> scale = <span class="hljs-number">0.5</span>

<span class="hljs-keyword">let</span> canvas = document.getElementById(<span class="hljs-string">"fable-drawing"</span>) :?&gt; HTMLCanvasElement
canvas.width  &lt;- tile
canvas.height &lt;- tile
<span class="hljs-keyword">let</span> ctx = canvas.getContext_2d()
(canvas, ctx)

<span class="hljs-keyword">let</span> r = scale / <span class="hljs-number">2.</span> * tile
<span class="hljs-keyword">let</span> x = tile / <span class="hljs-number">2.</span>
ctx.strokeStyle &lt;- !^<span class="hljs-string">"#aaa"</span>
ctx.beginPath()
ctx.arc(x, x, r, <span class="hljs-number">0.</span>, <span class="hljs-number">360.</span>)
ctx.stroke()</code></pre>
<ul>
<li>Add the following web.config.js </li>
</ul>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);

<span class="hljs-built_in">module</span>.exports = {
    <span class="hljs-attr">mode</span>: <span class="hljs-string">"development"</span>,
    <span class="hljs-attr">entry</span>: <span class="hljs-string">"./fable.fsx"</span>,
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.join(__dirname, <span class="hljs-string">"./"</span>),
        <span class="hljs-attr">filename</span>: <span class="hljs-string">"fable-fsx.js"</span>,
    },
    <span class="hljs-attr">devServer</span>: {
        <span class="hljs-attr">contentBase</span>: <span class="hljs-string">"./"</span>,
        <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,
    },
    <span class="hljs-attr">module</span>: {
        <span class="hljs-attr">rules</span>: [{
            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.fs(x|proj)?$/</span>,
            <span class="hljs-attr">use</span>: <span class="hljs-string">"fable-loader"</span>
        }]
    }
}</code></pre>
<ul>
<li>Run <code>npm init</code></li>
<li>Add the following lines to a <code>package.json</code></li>
</ul>
<pre><code class="language-json">  ...
  &quot;devDependencies&quot;: {
    &quot;@babel/core&quot;: &quot;^7.7.7&quot;,
    &quot;fable-compiler&quot;: &quot;^2.4.11&quot;,
    &quot;fable-loader&quot;: &quot;^2.1.8&quot;,
    &quot;webpack&quot;: &quot;^4.41.4&quot;,
    &quot;webpack-cli&quot;: &quot;^3.3.10&quot;
  },
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;webpack --config webpack.config.js --mode production&quot;
  },
  ...</code></pre>
<ul>
<li>Run <code>npm install</code></li>
<li>Run <code>npm run build</code></li>
<li>Load the <code>test.html</code> in a browser</li>
</ul>
<h2><a name="to-transpile-or-not-to-transpile" class="anchor" href="#to-transpile-or-not-to-transpile">To Transpile or Not To Transpile</a></h2><p>After going through this bootstrap of a Fable canvas example, it is worth reflecting whether this was worth it.  </p>
<p>If the objective was to simple draw a circle in canvas then going through all of this was overkill.  However, most of the work was environmental in nature.  We can reuse all of the setup for future Fable projects on our system, and we get the functional, type-safe experience with F#.  </p>
</div></div></div></div></section><script src="/assets/js/site.js"></script></body></html>