<!DOCTYPE html>
<html data-reactroot="" lang="en"><head><title>Joel Vandiver / Blog</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible"/><link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon"/><link rel="stylesheet" href="/assets/vendor/fontawesome-free/css/all.min.css"/><link rel="stylesheet" type="text/css" href="/assets/css/site.css"/></head><body class="container"><a class="sidebar" href="/"><h1>Joel Vandiver</h1><img src="/assets/fractal-logo.svg"/></a><div class="main"><h1><a name="Convert-Spreadsheet-Column-Headers-to-a-Number" class="anchor" href="#Convert-Spreadsheet-Column-Headers-to-a-Number">Convert Spreadsheet Column Headers to a Number</a></h1>
<h3><a name="Expected-Sample-Set" class="anchor" href="#Expected-Sample-Set">Expected Sample Set:</a></h3>
<table>
<thead>
<tr class="header">
<th><p>x</p></th>
<th><p>y</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>A</p></td>
<td><p>1</p></td>
</tr>
<tr class="even">
<td><p>B</p></td>
<td><p>2</p></td>
</tr>
<tr class="odd">
<td><p>C</p></td>
<td><p>3</p></td>
</tr>
<tr class="even">
<td><p>D</p></td>
<td><p>4</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p>...</p></td>
</tr>
<tr class="even">
<td><p>AA</p></td>
<td><p>27</p></td>
</tr>
<tr class="odd">
<td><p>AB</p></td>
<td><p>28</p></td>
</tr>
<tr class="even">
<td><p>AC</p></td>
<td><p>29</p></td>
</tr>
<tr class="odd">
<td><p>AD</p></td>
<td><p>30</p></td>
</tr>
<tr class="even">
<td><p>AE</p></td>
<td><p>31</p></td>
</tr>
<tr class="odd">
<td><p>...</p></td>
<td><p>...</p></td>
</tr>
</tbody>
</table>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, '1', 1)" onmouseover="showTip(event, '1', 1)" class="id">System</span>
</code></pre></td>
</tr>
</table>
<blockquote>
<p>Step 1.  Define the Alpha String</p>
</blockquote>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, '2', 2)" onmouseover="showTip(event, '2', 2)" class="id">alpha</span> <span class="o">=</span> <span class="s">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>
</code></pre></td>
</tr>
</table>
<blockquote>
<p>Step 2.  Define the convertText function that accepts the text as input and returns an int.</p>
</blockquote>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, '3', 3)" onmouseover="showTip(event, '3', 3)" class="fn">convertText</span> <span class="pn">(</span><span onmouseout="hideTip(event, '4', 4)" onmouseover="showTip(event, '4', 4)" class="id">text</span><span class="pn">:</span> <span onmouseout="hideTip(event, '5', 5)" onmouseover="showTip(event, '5', 5)" class="rt">string</span><span class="pn">)</span> <span class="pn">:</span> <span onmouseout="hideTip(event, '6', 6)" onmouseover="showTip(event, '6', 6)" class="vt">int</span> <span class="o">=</span>
   <span onmouseout="hideTip(event, '4', 7)" onmouseover="showTip(event, '4', 7)" class="id">text</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '7', 8)" onmouseover="showTip(event, '7', 8)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '8', 9)" onmouseover="showTip(event, '8', 9)" class="id">ofSeq</span>   <span class="c">// Convert the string to a list of chars.</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '7', 10)" onmouseover="showTip(event, '7', 10)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '9', 11)" onmouseover="showTip(event, '9', 11)" class="id">rev</span>     <span class="c">// Revs the list so that the index starts in the lowest order.</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '7', 12)" onmouseover="showTip(event, '7', 12)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '10', 13)" onmouseover="showTip(event, '10', 13)" class="id">mapi</span><span class="pn">(</span>   <span class="c">// Use map to include the index with the alpha char.</span>
         <span class="k">fun</span> <span onmouseout="hideTip(event, '11', 14)" onmouseover="showTip(event, '11', 14)" class="id">i</span> <span onmouseout="hideTip(event, '12', 15)" onmouseover="showTip(event, '12', 15)" class="id">a</span> <span class="k">-&gt;</span> 
            <span class="c">// Found the power of 26 to get the multiplier at each index place.</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, '13', 16)" onmouseover="showTip(event, '13', 16)" class="id">power26</span> <span class="o">=</span> <span onmouseout="hideTip(event, '14', 17)" onmouseover="showTip(event, '14', 17)" class="rt">Math</span><span class="pn">.</span><span onmouseout="hideTip(event, '15', 18)" onmouseover="showTip(event, '15', 18)" class="id">Pow</span><span class="pn">(</span><span class="n">26.</span><span class="pn">,</span> <span class="pn">(</span><span onmouseout="hideTip(event, '16', 19)" onmouseover="showTip(event, '16', 19)" class="fn">float</span> <span onmouseout="hideTip(event, '11', 20)" onmouseover="showTip(event, '11', 20)" class="id">i</span><span class="pn">)</span><span class="pn">)</span>
            <span class="c">// Conver the index of the alpha char from the original list (not the reversed list).</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, '17', 21)" onmouseover="showTip(event, '17', 21)" class="id">alphaIndex</span> <span class="o">=</span> <span onmouseout="hideTip(event, '2', 22)" onmouseover="showTip(event, '2', 22)" class="fn">alpha</span><span class="pn">.</span><span onmouseout="hideTip(event, '18', 23)" onmouseover="showTip(event, '18', 23)" class="id">IndexOf</span><span class="pn">(</span><span onmouseout="hideTip(event, '12', 24)" onmouseover="showTip(event, '12', 24)" class="id">a</span><span class="pn">)</span> <span class="o">+</span> <span class="n">1</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '16', 25)" onmouseover="showTip(event, '16', 25)" class="fn">float</span>
            <span class="c">// Multiply the final power to the alpha index and conver to and int from a double.</span>
            <span class="k">let</span> <span onmouseout="hideTip(event, '19', 26)" onmouseover="showTip(event, '19', 26)" class="id">result</span> <span class="o">=</span> <span onmouseout="hideTip(event, '13', 27)" onmouseover="showTip(event, '13', 27)" class="id">power26</span> <span class="o">*</span> <span onmouseout="hideTip(event, '17', 28)" onmouseover="showTip(event, '17', 28)" class="id">alphaIndex</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '6', 29)" onmouseover="showTip(event, '6', 29)" class="fn">int</span>
            <span onmouseout="hideTip(event, '19', 30)" onmouseover="showTip(event, '19', 30)" class="id">result</span><span class="pn">)</span>
   <span class="c">// Sum the final list.</span>
   <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '7', 31)" onmouseover="showTip(event, '7', 31)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '20', 32)" onmouseover="showTip(event, '20', 32)" class="id">reduce</span><span class="pn">(</span><span class="o">+</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p><em>Output:</em></p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="console">val alpha : string = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
val convertText : text:string -&gt; int
</code></pre></td></tr></table>
<h3><a name="Test" class="anchor" href="#Test">Test</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, '21', 33)" onmouseover="showTip(event, '21', 33)" class="id">data</span> <span class="o">=</span> <span class="pn">[</span><span class="s">&quot;AA&quot;</span><span class="pn">;</span> <span class="s">&quot;AB&quot;</span><span class="pn">;</span> <span class="s">&quot;AC&quot;</span><span class="pn">;</span> <span class="s">&quot;AD&quot;</span><span class="pn">;</span> <span class="s">&quot;AE&quot;</span><span class="pn">;</span> <span class="s">&quot;AF&quot;</span><span class="pn">;</span> <span class="s">&quot;AG&quot;</span><span class="pn">;</span> <span class="s">&quot;AH&quot;</span><span class="pn">;</span> <span class="s">&quot;AI&quot;</span><span class="pn">;</span> <span class="s">&quot;AJ&quot;</span><span class="pn">;</span><span class="pn">]</span>
<span class="k">let</span> <span onmouseout="hideTip(event, '22', 34)" onmouseover="showTip(event, '22', 34)" class="id">expected</span> <span class="o">=</span> <span class="pn">[</span><span class="n">27</span><span class="pn">;</span> <span class="n">28</span><span class="pn">;</span> <span class="n">29</span><span class="pn">;</span> <span class="n">30</span><span class="pn">;</span> <span class="n">31</span><span class="pn">;</span> <span class="n">32</span><span class="pn">;</span> <span class="n">33</span><span class="pn">;</span> <span class="n">34</span><span class="pn">;</span> <span class="n">35</span><span class="pn">;</span> <span class="n">36</span><span class="pn">;</span><span class="pn">]</span> 

<span class="k">let</span> <span onmouseout="hideTip(event, '23', 35)" onmouseover="showTip(event, '23', 35)" class="id">result</span> <span class="o">=</span> <span onmouseout="hideTip(event, '21', 36)" onmouseover="showTip(event, '21', 36)" class="id">data</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '7', 37)" onmouseover="showTip(event, '7', 37)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '24', 38)" onmouseover="showTip(event, '24', 38)" class="id">map</span> <span onmouseout="hideTip(event, '3', 39)" onmouseover="showTip(event, '3', 39)" class="fn">convertText</span>
<span class="k">let</span> <span onmouseout="hideTip(event, '25', 40)" onmouseover="showTip(event, '25', 40)" class="id">test</span> <span class="o">=</span> <span onmouseout="hideTip(event, '22', 41)" onmouseover="showTip(event, '22', 41)" class="id">expected</span> <span class="o">=</span> <span onmouseout="hideTip(event, '23', 42)" onmouseover="showTip(event, '23', 42)" class="id">result</span>
</code></pre></td>
</tr>
</table>
<p><em>Output:</em></p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="console">val data : string list =
  ["AA"; "AB"; "AC"; "AD"; "AE"; "AF"; "AG"; "AH"; "AI"; "AJ"]
val expected : int list = [27; 28; 29; 30; 31; 32; 33; 34; 35; 36]
val result : int list = [27; 28; 29; 30; 31; 32; 33; 34; 35; 36]
val test : bool = true
</code></pre></td></tr></table>
<a href="javascript:history.back()"><i class="fa fa-arrow-alt-circle-left"></i>Back</a><script src="/assets/vendor/jquery/jquery.min.js"></script><script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script><script src="/assets/js/literate.js"></script></div></body></html>