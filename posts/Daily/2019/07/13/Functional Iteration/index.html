<!DOCTYPE html>
<html data-reactroot="" lang="en"><head><title>Joel Vandiver / Blog</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible"/><link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon"/><link rel="stylesheet" href="/assets/vendor/fontawesome-free/css/all.min.css"/><link rel="stylesheet" type="text/css" href="/assets/css/site.css"/></head><body class="container"><a class="sidebar" href="/"><h1>Joel Vandiver</h1><img src="/assets/fractal-logo.svg"/></a><div class="main"><h1><a name="Functional-Iteration" class="anchor" href="#Functional-Iteration">Functional Iteration</a></h1>
<p>07-13-2019</p>
<p>.NET has a few instances of collections types that do not inherit from IEnumberable<'T>.  The <a href="https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/sequences">Seq<'T> is an alias of the IEnumerable<'T></a>.  In dealing with these collection types that do not have a correlation to sequences, you will likely have to iterate through the collection.</p>
<p>One way to do so without maintaining mutable state is to use the <code>yield</code> keyword.</p>
<p>For example, the .NET type, DataTable and DataTableCollection, do not support IEnumerable.</p>
<p>Suppose, we had loaded the following data from a remote data connection:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, '1', 1)" onmouseover="showTip(event, '1', 1)" class="id">set</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, '2', 2)" onmouseover="showTip(event, '2', 2)" class="id">System</span><span class="pn">.</span><span class="id">Data</span><span class="pn">.</span><span class="id">DataSet</span><span class="pn">(</span><span class="s">&quot;Superheros&quot;</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, '3', 3)" onmouseover="showTip(event, '3', 3)" class="id">table</span> <span class="o">=</span> <span class="k">new</span> <span onmouseout="hideTip(event, '2', 4)" onmouseover="showTip(event, '2', 4)" class="id">System</span><span class="pn">.</span><span class="id">Data</span><span class="pn">.</span><span class="id">DataTable</span><span class="pn">(</span><span class="s">&quot;Avengers&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '1', 5)" onmouseover="showTip(event, '1', 5)" class="id">set</span><span class="pn">.</span><span class="id">Tables</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span onmouseout="hideTip(event, '3', 6)" onmouseover="showTip(event, '3', 6)" class="id">table</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '3', 7)" onmouseover="showTip(event, '3', 7)" class="id">table</span><span class="pn">.</span><span class="id">Columns</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span class="s">&quot;id&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '3', 8)" onmouseover="showTip(event, '3', 8)" class="id">table</span><span class="pn">.</span><span class="id">Columns</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span class="s">&quot;name&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '3', 9)" onmouseover="showTip(event, '3', 9)" class="id">table</span><span class="pn">.</span><span class="id">Rows</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span class="n">1</span><span class="pn">,</span> <span class="s">&quot;Tony Stark&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '3', 10)" onmouseover="showTip(event, '3', 10)" class="id">table</span><span class="pn">.</span><span class="id">Rows</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span class="n">2</span><span class="pn">,</span> <span class="s">&quot;Captain America&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '3', 11)" onmouseover="showTip(event, '3', 11)" class="id">table</span><span class="pn">.</span><span class="id">Rows</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span class="n">3</span><span class="pn">,</span> <span class="s">&quot;Thor&quot;</span><span class="pn">)</span>
<span onmouseout="hideTip(event, '3', 12)" onmouseover="showTip(event, '3', 12)" class="id">table</span><span class="pn">.</span><span class="id">Rows</span><span class="pn">.</span><span class="id">Add</span><span class="pn">(</span><span class="n">4</span><span class="pn">,</span> <span class="s">&quot;4&quot;</span><span class="pn">)</span>
</code></pre></td>
</tr>
</table>
<p>Then, to process the data into a normal F# type, we can use the <code>yield</code> to extract the values we desire:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, '4', 13)" onmouseover="showTip(event, '4', 13)" class="id">heros</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, '5', 14)" onmouseover="showTip(event, '5', 14)" class="k">seq</span> <span class="pn">{</span> 
        <span class="k">for</span> <span onmouseout="hideTip(event, '6', 15)" onmouseover="showTip(event, '6', 15)" class="id">i</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, '1', 16)" onmouseover="showTip(event, '1', 16)" class="id">set</span><span class="pn">.</span><span class="id">Tables</span><span class="pn">.</span><span class="id">Count</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span> 
            <span class="k">let</span> <span onmouseout="hideTip(event, '3', 17)" onmouseover="showTip(event, '3', 17)" class="id">table</span> <span class="o">=</span> <span onmouseout="hideTip(event, '1', 18)" onmouseover="showTip(event, '1', 18)" class="id">set</span><span class="pn">.</span><span class="id">Tables</span><span class="pn">.</span><span class="pn">[</span><span onmouseout="hideTip(event, '6', 19)" onmouseover="showTip(event, '6', 19)" class="id">i</span><span class="pn">]</span>
            <span class="k">for</span> <span onmouseout="hideTip(event, '7', 20)" onmouseover="showTip(event, '7', 20)" class="id">j</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, '3', 21)" onmouseover="showTip(event, '3', 21)" class="id">table</span><span class="pn">.</span><span class="id">Rows</span><span class="pn">.</span><span class="id">Count</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
                <span class="k">let</span> <span onmouseout="hideTip(event, '8', 22)" onmouseover="showTip(event, '8', 22)" class="id">row</span> <span class="o">=</span> <span onmouseout="hideTip(event, '3', 23)" onmouseover="showTip(event, '3', 23)" class="id">table</span><span class="pn">.</span><span class="id">Rows</span><span class="pn">.</span><span class="pn">[</span><span onmouseout="hideTip(event, '7', 24)" onmouseover="showTip(event, '7', 24)" class="id">j</span><span class="pn">]</span>
                <span class="k">yield</span> 
                    <span onmouseout="hideTip(event, '5', 25)" onmouseover="showTip(event, '5', 25)" class="k">seq</span> <span class="pn">{</span> 
                        <span class="k">let</span> <span onmouseout="hideTip(event, '9', 26)" onmouseover="showTip(event, '9', 26)" class="id">cells</span> <span class="o">=</span> <span onmouseout="hideTip(event, '8', 27)" onmouseover="showTip(event, '8', 27)" class="id">row</span><span class="pn">.</span><span class="id">ItemArray</span>
                        <span class="k">for</span> <span onmouseout="hideTip(event, '10', 28)" onmouseover="showTip(event, '10', 28)" class="id">k</span> <span class="k">in</span> <span class="n">0</span> <span class="o">..</span> <span onmouseout="hideTip(event, '9', 29)" onmouseover="showTip(event, '9', 29)" class="id">cells</span><span class="pn">.</span><span class="id">Length</span> <span class="o">-</span> <span class="n">1</span> <span class="k">do</span>
                            <span class="k">yield</span> <span onmouseout="hideTip(event, '9', 30)" onmouseover="showTip(event, '9', 30)" class="id">cells</span><span class="pn">.</span><span class="pn">[</span><span onmouseout="hideTip(event, '10', 31)" onmouseover="showTip(event, '10', 31)" class="id">k</span><span class="pn">]</span> <span class="pn">}</span>
                    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '11', 32)" onmouseover="showTip(event, '11', 32)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '12', 33)" onmouseover="showTip(event, '12', 33)" class="id">ofSeq</span>
        <span class="pn">}</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, '11', 34)" onmouseover="showTip(event, '11', 34)" class="m">List</span><span class="pn">.</span><span onmouseout="hideTip(event, '12', 35)" onmouseover="showTip(event, '12', 35)" class="id">ofSeq</span>

<span onmouseout="hideTip(event, '13', 36)" onmouseover="showTip(event, '13', 36)" class="fn">printfn</span> <span class="s">&quot;%A&quot;</span> <span onmouseout="hideTip(event, '4', 37)" onmouseover="showTip(event, '4', 37)" class="id">heros</span>
</code></pre></td>
</tr>
</table>
<blockquote>
<p>Output:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">val</span> <span class="id">heros</span> <span class="pn">:</span> <span onmouseout="hideTip(event, '14', 38)" onmouseover="showTip(event, '14', 38)" class="id">obj</span> <span onmouseout="hideTip(event, '15', 39)" onmouseover="showTip(event, '15', 39)" class="id">list</span> <span onmouseout="hideTip(event, '15', 40)" onmouseover="showTip(event, '15', 40)" class="id">list</span> <span class="o">=</span>
  <span class="pn">[</span><span class="pn">[</span><span class="s">&quot;1&quot;</span><span class="pn">;</span> <span class="s">&quot;Tony Stark&quot;</span><span class="pn">]</span><span class="pn">;</span> <span class="pn">[</span><span class="s">&quot;2&quot;</span><span class="pn">;</span> <span class="s">&quot;Captain America&quot;</span><span class="pn">]</span><span class="pn">;</span> <span class="pn">[</span><span class="s">&quot;3&quot;</span><span class="pn">;</span> <span class="s">&quot;Thor&quot;</span><span class="pn">]</span><span class="pn">;</span> <span class="pn">[</span><span class="s">&quot;4&quot;</span><span class="pn">;</span> <span class="s">&quot;4&quot;</span><span class="pn">]</span><span class="pn">]</span>
</code></pre></td>
</tr>
</table>
</blockquote>
<script src="/assets/vendor/jquery/jquery.min.js"></script><script src="/assets/vendor/jquery-easing/jquery.easing.min.js"></script><script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script src="/assets/js/literate.js"></script></div></body></html>